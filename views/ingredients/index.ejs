<%- include('../partials/header') %>

<div class="buttons">
  <a href="/ingredients/new-option" class="btn btn-primary m-2">New Ingredient</a>
</div>

<div class="container-md">
  <h2><%= title %></h2>
</div>

<div class="d-flex flex-wrap justify-content-center">
  <% ingredients.forEach( ing => { %>
    <a href="/ingredients/<%= ing.id  %>">
      <div id="items-cont" class="shadow p-3 m-3 bg-body rounded">
        <h3 class="text-truncate"><%= ing.name %></h3>
        <h6 class="d-inline"><%= Math.ceil(ing.kcal) %> Cal</h6><small> (100g)</small>
        <br>
        <% if (ing.image) { %>
          <img src="<%= ing.image %>" alt="item image" class="rounded mx-auto d-block">
        <% } else { %>
          <img src="/images/comingsoon.jpeg" alt="comingsoon image">
        <% } %>
        <% 
          let totalP = ing.protein
          let totalC = ing.carbs
          let totalF = ing.fat
          
          const total = totalP + totalC + totalF 
          const protPerc = Math.ceil(totalP/total*100)
          const carbPerc = Math.ceil(totalC/total*100)
          const fatPerc = Math.ceil(totalF/total*100)
        %>
        
        <div class="progress mt-2">
          <div class="progress-bar" role="progressbar" style="width: <%= protPerc %>%" aria-valuenow="15" aria-valuemin="0" aria-valuemax="100"></div>
          <div class="progress-bar bg-warning" role="progressbar" style="width: <%= carbPerc %>%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
          <div class="progress-bar bg-danger" role="progressbar" style="width: <%= fatPerc %>%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
      </div>
    </a>
  <% }) %>
</div>
  
  

<%- include('../partials/footer') %>