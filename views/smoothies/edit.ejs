<%- include('../partials/header') %>

<div class="container">
  <div class="row">
    <div class="col m-4">
      <h2>Enter information</h2>
      <form action="/smoothies/<%= smoothie.id %>/edit" method="POST">
        <div class="form-group">
          <label>Name
              <input name="name" value="smoothie.name" type="text" class="form-control m-2" required>
          </label>
        </div>
        <div class="form-group">
          <label>Ingredient
            <select name="ingredientId" class="form-control m-2">
              <!-- Emit an option for each performer -->
              <%- ingredients.map(ing => 
                `<option value="${ing._id}">${ing.name}</option>`
              ).join('') %>
            </select>
              <input name="qty" type="text" class="form-control m-2" placeholder="quantity in grams" required>
          </label>
          
        </div>
        <button type="submit" class="btn btn-success m-2">Add Ingredient</button>
      </form>
    </div>
    <div class="col m-4">
      <h4>These are the ingredients</h4>
      <table class="table">
        <thead>
            <th>name</th>
            <th>qty</th>
            <th>kcal</th>
            <th>protein</th>
            <th>carbs</th>
            <th>fat</th>
        </thead>
        <tbody>
          <% if(smoothie.ingredients.length !== 0){ %>
            <% smoothie.ingredients.forEach(ing => { %>
                <tr>
                    <td><%= ing.ing.name %></td> 
                    <td><%= ing.qty %></td> 
                    <td><%= ing.ing.kcal %></td> 
                    <td><%= ing.ing.protein %></td> 
                    <td><%= ing.ing.carbs %></td> 
                    <td><%= ing.ing.fat %></td> 
                    <td><a href="/smoothies/<%= smoothie.id %>">X</a></td>
                </tr>
                
            <% }) %>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>